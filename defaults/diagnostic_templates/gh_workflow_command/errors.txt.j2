{#
  Copyright The OpenTelemetry Authors
  SPDX-License-Identifier: Apache-2.0
  This file is:
  - a Jinja template,
  - used to generate semantic conventions,
  - using weaver.
  For doc on the template syntax:
  https://jinja.palletsprojects.com/en/3.0.x/
  For doc on the semantic conventions:
  https://github.com/open-telemetry/semantic-conventions
  For doc on weaver:
  https://github.com/open-telemetry/weaver
#}
{%- set policy_violations = ctx | selectattr("error.type", "equalto", "policy_violation") | list %}
{%- set other_diagnostics = ctx | rejectattr("error.type", "equalto", "policy_violation") | list %}

{%- if policy_violations %}
::group::Policy violation report
{%- for item in policy_violations %}
::error file={{ item.error.provenance }}, title={{ item.error.violation.id }}::message={{ item.error.violation.message }}
{%- endfor %}
::endgroup::
{% endif %}

{%- if other_diagnostics %}
::group::Diagnostic report
{% for item in policy_violations %}
{{ item.diagnostic.ansi_message }}
{% endfor %}
::endgroup::
{% endif %}