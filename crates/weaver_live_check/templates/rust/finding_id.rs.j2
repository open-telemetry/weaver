// SPDX-License-Identifier: Apache-2.0

//! Finding ID enum for live check findings.
//!
//! DO NOT EDIT â€” this file is generated by Weaver from `model/live_check.yaml`.
//! To regenerate, run from the repository root:
//!
//! ```sh
//! cargo run -- registry generate \
//!   --registry crates/weaver_live_check/model/ \
//!   --templates crates/weaver_live_check/templates/ \
//!   --v2 \
//!   rust \
//!   crates/weaver_live_check/src/
//! ```

use serde::{Deserialize, Serialize};
{% for attr in ctx.registry.attributes %}
{% if attr.key == "weaver.finding.id" %}

/// {{ attr.brief }}
///
{% for line in attr.note | trim | split("\n") %}
{% if line | trim | length > 0 %}
/// {{ line }}
{% else %}
///
{% endif %}
{% endfor %}
///
/// The `Custom` variant represents finding IDs from custom Rego policies
/// or other external sources not listed above.
#[derive(Debug, Clone, PartialEq, Eq, Hash, Serialize, Deserialize)]
#[derive(strum::Display, strum::EnumString)]
#[serde(rename_all = "snake_case")]
#[strum(serialize_all = "snake_case")]
pub enum FindingId {
{% for member in attr.type.members %}
    /// {{ member.brief }}
    {{ member.id | pascal_case }},
{% endfor %}
    /// A finding ID from a custom Rego policy or other external source
    #[serde(untagged)]
    #[strum(default)]
    Custom(String),
}

impl From<FindingId> for String {
    fn from(id: FindingId) -> Self {
        id.to_string()
    }
}
{% endif %}
{% endfor %}
